{"version":3,"sources":["/source/c3_renderers.coffee","c3_renderers.min.js"],"names":["callWithJQuery","pivotModule","exports","module","require","define","amd","jQuery","$","makeC3Chart","chartOpts","pivotData","opts","agg","attrs","base","base1","base2","base3","base4","base5","colKey","colKeys","columns","dataColumns","defaults","fullAggName","groupByTitle","h","hAxisTitle","headers","i","j","k","l","len","len1","len2","len3","len4","m","numCharsInHAxis","numSeries","params","ref","ref1","ref2","ref3","renderArea","result","rotationAngle","row","rowHeader","rowKey","rowKeys","s","scatterData","series","title","titleText","vAxisTitle","val","vals","x","xs","localeStrings","vs","by","c3","extend","size","width","window","innerWidth","height","innerHeight","type","getRowKeys","length","push","getColKeys","results","join","aggregatorName","valAttrs","y","t","rowAttrs","concat","colAttrs","slice","getAggregator","value","format","isNumeric","parseFloat","toPrecision","toFixed","style","text","axis","label","tick","rotate","multiline","data","tooltip","grouped","color","pattern","fit","legend","show","name","a","b","c","d","categories","stacked","groups","len5","n","appendTo","bindto","generate","detach","remove","append","pivotUtilities","c3_renderers","Line Chart","Bar Chart","Stacked Bar Chart","Area Chart","Scatter Chart","call","this"],"mappings":"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","file":"c3_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n        \ncallWithJQuery ($) ->\n\n    makeC3Chart = (chartOpts = {}) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n            c3: {}\n\n        opts = $.extend true, defaults, opts\n        opts.c3.size ?= {}\n        opts.c3.size.width ?= window.innerWidth / 1.4\n        opts.c3.size.height ?= window.innerHeight / 1.4 - 50\n        chartOpts.type ?= \"line\"\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in colKeys)\n        rotationAngle = 0\n\n        fullAggName = pivotData.aggregatorName \n        if pivotData.valAttrs.length\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\n\n        if chartOpts.type == \"scatter\"\n            scatterData = x:{}, y:{}, t:{}\n            attrs = pivotData.rowAttrs.concat(pivotData.colAttrs)\n            vAxisTitle = attrs[0] ? \"\"\n            hAxisTitle = attrs[1] ? \"\" \n            groupByTitle = attrs.slice(2).join(\"-\")\n            titleText = vAxisTitle\n            titleText += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\n            titleText += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\n            for rowKey in rowKeys\n                for colKey in colKeys\n                    agg = pivotData.getAggregator(rowKey, colKey)\n                    if agg.value()?\n                        vals = rowKey.concat(colKey)\n                        series = vals.slice(2).join(\"-\")\n                        if series == \"\" then series = \"series\"\n                        scatterData.x[series] ?= []\n                        scatterData.y[series] ?= []\n                        scatterData.t[series] ?= []\n                        scatterData.y[series].push vals[0] ? 0\n                        scatterData.x[series].push vals[1] ? 0\n                        scatterData.t[series].push agg.format(agg.value())\n        else\n            numCharsInHAxis = 0\n            for x in headers\n                numCharsInHAxis += x.length\n            if numCharsInHAxis > 50\n                rotationAngle = 45\n\n            columns = []\n            for rowKey in rowKeys\n                rowHeader = rowKey.join(\"-\")\n                row = [if rowHeader == \"\" then pivotData.aggregatorName else rowHeader]\n                for colKey in colKeys\n                    agg = pivotData.getAggregator(rowKey, colKey)\n                    if agg.value()?\n                        val = agg.value()\n                        if $.isNumeric val\n                            if val < 1\n                                row.push parseFloat(val.toPrecision(3))\n                            else\n                                row.push parseFloat(val.toFixed(3))\n                        else\n                            row.push val\n\n                    else row.push null\n                columns.push row\n\n            vAxisTitle = pivotData.aggregatorName+ \n                if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n\n            titleText = fullAggName\n            titleText += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\n            groupByTitle = pivotData.rowAttrs.join(\"-\")\n            titleText += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\n            \n        title = $(\"<p>\", {style: \"text-align: center; font-weight: bold\"})\n        title.text(titleText)\n\n        params = \n            axis: \n                y:\n                    label: vAxisTitle\n                x:\n                    label: hAxisTitle\n                    tick:\n                        rotate: rotationAngle\n                        multiline: false\n            data: \n                type: chartOpts.type\n            tooltip:\n                grouped: false\n            color: \n                pattern: [ \"#3366cc\", \"#dc3912\", \"#ff9900\", \"#109618\",\n                           \"#990099\", \"#0099c6\", \"#dd4477\", \"#66aa00\",\n                           \"#b82e2e\", \"#316395\", \"#994499\", \"#22aa99\",\n                           \"#aaaa11\", \"#6633cc\", \"#e67300\", \"#8b0707\",\n                           \"#651067\", \"#329262\", \"#5574a6\", \"#3b3eac\" ]\n\n\n        $.extend params, opts.c3\n\n        if chartOpts.type == \"scatter\"\n            xs = {}\n            numSeries = 0\n            dataColumns = []\n            for s of scatterData.x\n                numSeries += 1\n                xs[s] = s+\"_x\"\n                dataColumns.push [s+\"_x\"].concat(scatterData.x[s])\n                dataColumns.push [s].concat(scatterData.y[s])\n            params.data.xs = xs\n            params.data.columns = dataColumns\n            params.axis.x.tick = fit: false\n            if numSeries == 1\n                params.legend = show: false \n            params.tooltip.format =  \n                title: -> fullAggName\n                name: -> \"\"\n                value: (a,b,c,d) -> scatterData.t[c][d]\n        else\n            params.axis.x.type= 'category'\n            params.axis.x.categories = headers\n            params.data.columns = columns\n\n\n        if chartOpts.stacked?\n            params.data.groups = [x.join(\"-\") for x in rowKeys]\n        renderArea = $(\"<div>\", style: \"display:none;\").appendTo $(\"body\")\n        result = $(\"<div>\").appendTo renderArea\n        params.bindto = result[0]\n        c3.generate params\n        result.detach()\n        renderArea.remove()\n        return $(\"<div>\").append title, result\n\n    $.pivotUtilities.c3_renderers = \n        \"Line Chart\": makeC3Chart()\n        \"Bar Chart\": makeC3Chart(type: \"bar\")\n        \"Stacked Bar Chart\": makeC3Chart(type: \"bar\", stacked: true)\n        \"Area Chart\": makeC3Chart(type: \"area\", stacked: true)\n        \"Scatter Chart\": makeC3Chart(type: \"scatter\")\n","(function(){var t;(t=function(t){return\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"jquery\"),require(\"c3\")):\"function\"==typeof define&&define.amd?define([\"jquery\",\"c3\"],t):t(jQuery,c3)})(function(t,e){var a;return a=function(a){return null==a&&(a={}),function(r,n){var o,i,l,s,c,u,p,d,g,h,f,y,v,b,j,x,m,w,A,k,C,F,S,q,z,N,B,K,T,H,L,P,Q,R,U,W,_,D;if(h={localeStrings:{vs:\"vs\",by:\"by\"},c3:{}},n=t.extend(!0,h,n),null==(i=n.c3).size&&(i.size={}),null==(l=n.c3.size).width&&(l.width=window.innerWidth/1.4),null==(s=n.c3.size).height&&(s.height=window.innerHeight/1.4-50),null==a.type&&(a.type=\"line\"),L=r.getRowKeys(),0===L.length&&L.push([]),u=r.getColKeys(),0===u.length&&u.push([]),j=function(){var t,e,a;for(a=[],t=0,e=u.length;e>t;t++)v=u[t],a.push(v.join(\"-\"));return a}(),B=0,f=r.aggregatorName,r.valAttrs.length&&(f+=\"(\"+r.valAttrs.join(\", \")+\")\"),\"scatter\"===a.type){d=[],b=r.colAttrs.join(\"-\"),U=r.rowAttrs.join(\"-\"),q=r.tree;for(D in q){R=q[D];for(_ in R)o=R[_],g={},g[b]=parseFloat(_),g[U]=parseFloat(D),g.tooltip=o.format(o.value()),d.push(g)}}else{for(F=0,x=0,A=j.length;A>x;x++)_=j[x],F+=_.length;for(F>50&&(B=45),p=[],m=0,k=L.length;k>m;m++){for(H=L[m],T=H.join(\"-\"),K=[\"\"===T?r.aggregatorName:T],w=0,C=u.length;C>w;w++)c=u[w],o=r.getAggregator(H,c),null!=o.value()?(W=o.value(),K.push(t.isNumeric(W)?1>W?parseFloat(W.toPrecision(3)):parseFloat(W.toFixed(3)):W)):K.push(null);p.push(K)}U=r.aggregatorName+(r.valAttrs.length?\"(\"+r.valAttrs.join(\", \")+\")\":\"\"),b=r.colAttrs.join(\"-\")}return Q=f,\"\"!==b&&(Q+=\" \"+n.localeStrings.vs+\" \"+b),y=r.rowAttrs.join(\"-\"),\"\"!==y&&(Q+=\" \"+n.localeStrings.by+\" \"+y),P=t(\"<p>\",{style:\"text-align: center; font-weight: bold\"}),P.text(Q),S={axis:{y:{label:U},x:{label:b,tick:{rotate:B,multiline:!1}}},data:{type:a.type},tooltip:{grouped:!1},color:{pattern:[\"#3366cc\",\"#dc3912\",\"#ff9900\",\"#109618\",\"#990099\",\"#0099c6\",\"#dd4477\",\"#66aa00\",\"#b82e2e\",\"#316395\",\"#994499\",\"#22aa99\",\"#aaaa11\",\"#6633cc\",\"#e67300\",\"#8b0707\",\"#651067\",\"#329262\",\"#5574a6\",\"#3b3eac\"]}},t.extend(S,n.c3),\"scatter\"===a.type?(S.data.x=b,S.axis.x.tick={fit:!1},S.data.json=d,S.data.keys={value:[b,U]},S.legend={show:!1},S.tooltip.format={title:function(){return f},name:function(){return\"\"},value:function(t,e,a,r){return d[r].tooltip}}):(S.axis.x.type=\"category\",S.axis.x.categories=j,S.data.columns=p),null!=a.stacked&&(S.data.groups=[function(){var t,e,a;for(a=[],t=0,e=L.length;e>t;t++)_=L[t],a.push(_.join(\"-\"));return a}()]),z=t(\"<div>\",{style:\"display:none;\"}).appendTo(t(\"body\")),N=t(\"<div>\").appendTo(z),S.bindto=N[0],e.generate(S),N.detach(),z.remove(),t(\"<div>\").append(P,N)}},t.pivotUtilities.c3_renderers={\"Line Chart\":a(),\"Bar Chart\":a({type:\"bar\"}),\"Stacked Bar Chart\":a({type:\"bar\",stacked:!0}),\"Area Chart\":a({type:\"area\",stacked:!0}),\"Scatter Chart\":a({type:\"scatter\"})}})}).call(this);\n//# sourceMappingURL=c3_renderers.min.js.map"],"sourceRoot":"/source/"}